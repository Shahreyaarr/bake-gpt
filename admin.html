<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bake-GPT Admin | Bakery Management System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'serif': ['Playfair Display', 'serif'],
                        'sans': ['Poppins', 'sans-serif'],
                    },
                    colors: {
                        'bake-rose': '#E8B4B8',
                        'bake-rose-dark': '#D4A5A9',
                        'bake-cream': '#FDF6F0',
                        'bake-brown': '#8B6F47',
                        'bake-chocolate': '#5D4037',
                    }
                }
            }
        }
    </script>
    <style>
        .glass-effect { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); }
        .sidebar-link { transition: all 0.3s ease; }
        .sidebar-link:hover, .sidebar-link.active { background: rgba(232, 180, 184, 0.2); border-right: 3px solid #E8B4B8; }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .slide-in { animation: slideIn 0.3s ease-out; }
        @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #E8B4B8; border-radius: 4px; }
        .stat-card { background: linear-gradient(135deg, #fff 0%, #fdf6f0 100%); }
        .loading { display: inline-block; width: 20px; height: 20px; border: 3px solid rgba(255,255,255,.3); border-radius: 50%; border-top-color: #fff; animation: spin 1s ease-in-out infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body class="font-sans bg-gray-50">

    <!-- LOGIN PAGE -->
    <div id="login-page" class="min-h-screen flex items-center justify-center bg-gradient-to-br from-bake-cream to-bake-rose/30 p-4">
        <div class="bg-white p-8 rounded-3xl shadow-2xl w-full max-w-md mx-4 transform transition-all">
            <div class="text-center mb-8">
                <div class="w-20 h-20 bg-bake-rose rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg">
                    <i class="fas fa-bread-slice text-3xl text-white"></i>
                </div>
                <h1 class="font-serif text-3xl font-bold text-bake-chocolate">Bake-GPT Admin</h1>
                <p class="text-gray-500 mt-2">Bakery Management System</p>
            </div>
            
            <form id="login-form" onsubmit="handleLogin(event)" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
                    <div class="relative">
                        <i class="fas fa-envelope absolute left-3 top-3 text-gray-400"></i>
                        <input type="email" id="login-email" required 
                            class="w-full pl-10 pr-4 py-3 rounded-xl border border-gray-200 focus:border-bake-rose focus:ring-2 focus:ring-bake-rose/20 outline-none transition"
                            placeholder="admin@bakegpt.com" value="admin@bakegpt.com">
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                    <div class="relative">
                        <i class="fas fa-lock absolute left-3 top-3 text-gray-400"></i>
                        <input type="password" id="login-password" required 
                            class="w-full pl-10 pr-4 py-3 rounded-xl border border-gray-200 focus:border-bake-rose focus:ring-2 focus:ring-bake-rose/20 outline-none transition"
                            placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" value="admin123">
                    </div>
                    <p class="text-xs text-gray-500 mt-1">Default: admin@bakegpt.com / admin123</p>
                </div>

                <div class="flex items-center justify-between text-sm">
                    <label class="flex items-center">
                        <input type="checkbox" id="remember-me" class="rounded text-bake-rose focus:ring-bake-rose mr-2">
                        <span class="text-gray-600">Remember me</span>
                    </label>
                    <a href="#" onclick="showSetupGuide()" class="text-bake-rose hover:text-bake-rose-dark">Setup Guide</a>
                </div>

                <button type="submit" id="login-btn"
                    class="w-full bg-bake-chocolate text-white py-3 rounded-xl font-semibold hover:bg-bake-brown transition transform hover:scale-[1.02] flex items-center justify-center gap-2 shadow-lg">
                    <span id="btn-text">Sign In</span>
                    <i id="btn-icon" class="fas fa-arrow-right"></i>
                </button>
            </form>

            <div class="mt-6 text-center">
                <button onclick="loadDemoAndLogin()" class="text-sm bg-bake-rose/10 text-bake-rose px-4 py-2 rounded-full hover:bg-bake-rose hover:text-white transition">
                    <i class="fas fa-magic mr-1"></i> Load Demo Data & Login
                </button>
            </div>
        </div>
    </div>

    <!-- ADMIN DASHBOARD -->
    <div id="admin-dashboard" class="hidden min-h-screen flex">
        
        <!-- Sidebar -->
        <aside class="w-64 bg-white border-r border-gray-200 fixed h-full overflow-y-auto z-20 hidden md:block shadow-sm">
            <div class="p-6 border-b border-gray-100 bg-bake-cream/30">
                <div class="flex items-center gap-2 cursor-pointer" onclick="showSection('dashboard')">
                    <i class="fas fa-bread-slice text-2xl text-bake-rose"></i>
                    <div>
                        <span class="font-serif text-xl font-bold text-bake-chocolate">Bake-GPT</span>
                        <p class="text-xs text-gray-500">Admin Panel</p>
                    </div>
                </div>
            </div>

            <nav class="p-4 space-y-1">
                <button onclick="showSection('dashboard')" id="nav-dashboard" class="sidebar-link active w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left text-gray-700 hover:text-bake-chocolate font-medium">
                    <i class="fas fa-home w-5 text-center"></i>
                    <span>Dashboard</span>
                </button>
                
                <button onclick="showSection('orders')" id="nav-orders" class="sidebar-link w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left text-gray-700 hover:text-bake-chocolate font-medium">
                    <i class="fas fa-shopping-bag w-5 text-center"></i>
                    <span>Orders</span>
                    <span id="sidebar-order-count" class="ml-auto bg-red-500 text-white text-xs px-2 py-0.5 rounded-full hidden">0</span>
                </button>
                
                <button onclick="showSection('products')" id="nav-products" class="sidebar-link w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left text-gray-700 hover:text-bake-chocolate font-medium">
                    <i class="fas fa-cake w-5 text-center"></i>
                    <span>Products</span>
                </button>
                
                <button onclick="showSection('customers')" id="nav-customers" class="sidebar-link w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left text-gray-700 hover:text-bake-chocolate font-medium">
                    <i class="fas fa-users w-5 text-center"></i>
                    <span>Customers</span>
                </button>
                
                <button onclick="showSection('analytics')" id="nav-analytics" class="sidebar-link w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left text-gray-700 hover:text-bake-chocolate font-medium">
                    <i class="fas fa-chart-line w-5 text-center"></i>
                    <span>Analytics</span>
                </button>
                
                <button onclick="showSection('settings')" id="nav-settings" class="sidebar-link w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left text-gray-700 hover:text-bake-chocolate font-medium">
                    <i class="fas fa-cog w-5 text-center"></i>
                    <span>Settings</span>
                </button>
            </nav>

            <div class="absolute bottom-0 w-full p-4 border-t border-gray-100 bg-white">
                <div class="flex items-center gap-3 mb-4 p-2 bg-bake-cream/30 rounded-xl">
                    <div class="w-10 h-10 bg-bake-rose rounded-full flex items-center justify-center text-white font-bold text-lg">
                        S
                    </div>
                    <div class="overflow-hidden">
                        <p class="font-medium text-sm text-gray-800 truncate">Shahreyarr</p>
                        <p class="text-xs text-gray-500">Super Admin</p>
                    </div>
                </div>
                <button onclick="logout()" class="w-full flex items-center gap-2 px-4 py-3 rounded-xl text-red-600 hover:bg-red-50 transition text-sm font-medium border border-red-100">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </button>
            </div>
        </aside>

        <!-- Mobile Header -->
        <div class="md:hidden fixed top-0 w-full bg-white border-b border-gray-200 z-30 px-4 py-3 flex justify-between items-center shadow-sm">
            <div class="flex items-center gap-2">
                <i class="fas fa-bread-slice text-xl text-bake-rose"></i>
                <span class="font-serif text-lg font-bold text-bake-chocolate">Bake-GPT</span>
            </div>
            <button onclick="toggleMobileSidebar()" class="text-gray-600 p-2">
                <i class="fas fa-bars text-xl"></i>
            </button>
        </div>

        <!-- Mobile Sidebar -->
        <div id="mobile-sidebar" class="hidden fixed inset-0 z-40 bg-black/50 backdrop-blur-sm" onclick="toggleMobileSidebar()">
            <div class="absolute left-0 top-0 h-full w-64 bg-white shadow-2xl slide-in" onclick="event.stopPropagation()">
                <div class="p-6 border-b border-gray-100 flex justify-between items-center bg-bake-cream/30">
                    <span class="font-serif text-xl font-bold text-bake-chocolate">Menu</span>
                    <button onclick="toggleMobileSidebar()" class="text-gray-500 p-2 hover:bg-gray-100 rounded-full">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                <nav class="p-4 space-y-1">
                    <button onclick="showSection('dashboard'); toggleMobileSidebar()" class="w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left text-gray-700 hover:bg-bake-rose/10">
                        <i class="fas fa-home w-5 text-center"></i> Dashboard
                    </button>
                    <button onclick="showSection('orders'); toggleMobileSidebar()" class="w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left text-gray-700 hover:bg-bake-rose/10">
                        <i class="fas fa-shopping-bag w-5 text-center"></i> Orders
                    </button>
                    <button onclick="showSection('products'); toggleMobileSidebar()" class="w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left text-gray-700 hover:bg-bake-rose/10">
                        <i class="fas fa-cake w-5 text-center"></i> Products
                    </button>
                    <button onclick="showSection('customers'); toggleMobileSidebar()" class="w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left text-gray-700 hover:bg-bake-rose/10">
                        <i class="fas fa-users w-5 text-center"></i> Customers
                    </button>
                    <button onclick="logout()" class="w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left text-red-600 hover:bg-red-50 mt-4 border-t border-gray-100">
                        <i class="fas fa-sign-out-alt w-5 text-center"></i> Logout
                    </button>
                </nav>
            </div>
        </div>

        <!-- Main Content -->
        <main class="flex-1 md:ml-64 pt-16 md:pt-0 min-h-screen bg-gray-50">
            
            <!-- Top Header -->
            <header class="bg-white border-b border-gray-200 px-4 md:px-8 py-4 flex justify-between items-center sticky top-0 z-10 shadow-sm">
                <div>
                    <h2 id="page-title" class="text-xl md:text-2xl font-serif font-bold text-bake-chocolate">Dashboard</h2>
                    <p id="current-date" class="text-xs md:text-sm text-gray-500 mt-0.5"></p>
                </div>
                <div class="flex items-center gap-2 md:gap-4">
                    <button onclick="refreshData()" class="p-2 text-gray-600 hover:text-bake-rose transition rounded-full hover:bg-gray-100" title="Refresh Data">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                    <div class="relative">
                        <button onclick="toggleNotifications()" class="p-2 text-gray-600 hover:text-bake-rose transition rounded-full hover:bg-gray-100 relative">
                            <i class="fas fa-bell"></i>
                            <span id="notif-badge" class="absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full hidden"></span>
                        </button>
                        <div id="notifications-dropdown" class="hidden absolute right-0 mt-2 w-80 bg-white rounded-xl shadow-xl border border-gray-100 z-50 overflow-hidden">
                            <div class="p-4 border-b border-gray-100 bg-bake-cream/30">
                                <h4 class="font-bold text-gray-800">Notifications</h4>
                            </div>
                            <div id="notifications-list" class="max-h-64 overflow-y-auto p-2">
                                <p class="text-center text-gray-400 py-8 text-sm">No new notifications</p>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <div class="p-4 md:p-8">
                
                <!-- DASHBOARD SECTION -->
                <div id="section-dashboard" class="fade-in space-y-6">
                    <!-- Stats Grid -->
                    <div class="grid grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6">
                        <div class="stat-card p-4 md:p-6 rounded-2xl shadow-sm border border-gray-100 hover:shadow-md transition">
                            <div class="flex justify-between items-start">
                                <div>
                                    <p class="text-gray-500 text-xs md:text-sm mb-1">Today's Orders</p>
                                    <h3 class="text-2xl md:text-3xl font-bold text-bake-chocolate" id="stat-today-orders">0</h3>
                                    <p class="text-xs text-green-600 mt-1"><i class="fas fa-arrow-up mr-1"></i><span id="stat-orders-trend">0%</span></p>
                                </div>
                                <div class="w-10 h-10 md:w-12 md:h-12 bg-bake-rose/20 rounded-xl flex items-center justify-center text-bake-rose">
                                    <i class="fas fa-shopping-bag text-lg md:text-xl"></i>
                                </div>
                            </div>
                        </div>

                        <div class="stat-card p-4 md:p-6 rounded-2xl shadow-sm border border-gray-100 hover:shadow-md transition">
                            <div class="flex justify-between items-start">
                                <div>
                                    <p class="text-gray-500 text-xs md:text-sm mb-1">Revenue Today</p>
                                    <h3 class="text-2xl md:text-3xl font-bold text-bake-chocolate" id="stat-today-revenue">â‚¹0</h3>
                                    <p class="text-xs text-green-600 mt-1"><i class="fas fa-arrow-up mr-1"></i><span id="stat-revenue-trend">0%</span></p>
                                </div>
                                <div class="w-10 h-10 md:w-12 md:h-12 bg-green-100 rounded-xl flex items-center justify-center text-green-600">
                                    <i class="fas fa-rupee-sign text-lg md:text-xl"></i>
                                </div>
                            </div>
                        </div>

                        <div class="stat-card p-4 md:p-6 rounded-2xl shadow-sm border border-gray-100 hover:shadow-md transition">
                            <div class="flex justify-between items-start">
                                <div>
                                    <p class="text-gray-500 text-xs md:text-sm mb-1">Pending</p>
                                    <h3 class="text-2xl md:text-3xl font-bold text-orange-600" id="stat-pending">0</h3>
                                    <p class="text-xs text-orange-600 mt-1">Needs attention</p>
                                </div>
                                <div class="w-10 h-10 md:w-12 md:h-12 bg-orange-100 rounded-xl flex items-center justify-center text-orange-600">
                                    <i class="fas fa-clock text-lg md:text-xl"></i>
                                </div>
                            </div>
                        </div>

                        <div class="stat-card p-4 md:p-6 rounded-2xl shadow-sm border border-gray-100 hover:shadow-md transition">
                            <div class="flex justify-between items-start">
                                <div>
                                    <p class="text-gray-500 text-xs md:text-sm mb-1">Customers</p>
                                    <h3 class="text-2xl md:text-3xl font-bold text-bake-chocolate" id="stat-customers">0</h3>
                                    <p class="text-xs text-blue-600 mt-1"><i class="fas fa-user-plus mr-1"></i><span id="stat-new-customers">0</span> new</p>
                                </div>
                                <div class="w-10 h-10 md:w-12 md:h-12 bg-blue-100 rounded-xl flex items-center justify-center text-blue-600">
                                    <i class="fas fa-users text-lg md:text-xl"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Charts Row -->
                    <div class="grid lg:grid-cols-2 gap-4 md:gap-6">
                        <div class="bg-white p-4 md:p-6 rounded-2xl shadow-sm border border-gray-100">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="font-bold text-gray-800 text-sm md:text-base">Sales Overview (Last 7 Days)</h3>
                                <select class="text-xs border border-gray-200 rounded-lg px-2 py-1 outline-none focus:border-bake-rose">
                                    <option>This Week</option>
                                    <option>Last Week</option>
                                </select>
                            </div>
                            <div class="relative h-48 md:h-64">
                                <canvas id="salesChart"></canvas>
                            </div>
                        </div>
                        <div class="bg-white p-4 md:p-6 rounded-2xl shadow-sm border border-gray-100">
                            <h3 class="font-bold text-gray-800 text-sm md:text-base mb-4">Popular Products</h3>
                            <div class="relative h-48 md:h-64">
                                <canvas id="productsChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Orders & Quick Actions -->
                    <div class="grid lg:grid-cols-3 gap-4 md:gap-6">
                        <div class="lg:col-span-2 bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                            <div class="p-4 md:p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50/50">
                                <h3 class="font-bold text-gray-800 text-sm md:text-base">Recent Orders</h3>
                                <button onclick="showSection('orders')" class="text-bake-rose text-xs md:text-sm hover:underline font-medium">View All</button>
                            </div>
                            <div id="recent-orders-list" class="divide-y divide-gray-100 max-h-96 overflow-y-auto">
                                <div class="p-8 text-center text-gray-400">
                                    <i class="fas fa-inbox text-4xl mb-3 text-gray-300"></i>
                                    <p class="text-sm">No orders yet</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-4 md:p-6">
                            <h3 class="font-bold text-gray-800 text-sm md:text-base mb-4">Quick Actions</h3>
                            <div class="space-y-3">
                                <button onclick="openAddProductModal()" class="w-full flex items-center gap-3 p-3 md:p-4 rounded-xl border-2 border-dashed border-bake-rose/30 hover:border-bake-rose hover:bg-bake-rose/5 transition text-left group">
                                    <div class="w-10 h-10 bg-bake-rose/20 rounded-lg flex items-center justify-center text-bake-rose group-hover:bg-bake-rose group-hover:text-white transition">
                                        <i class="fas fa-plus"></i>
                                    </div>
                                    <div>
                                        <p class="font-medium text-gray-800 text-sm">Add New Product</p>
                                        <p class="text-xs text-gray-500">Create new menu item</p>
                                    </div>
                                </button>
                                
                                <button onclick="showSection('orders')" class="w-full flex items-center gap-3 p-3 md:p-4 rounded-xl border-2 border-dashed border-gray-200 hover:border-gray-400 hover:bg-gray-50 transition text-left group">
                                    <div class="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center text-gray-600 group-hover:bg-gray-200 transition">
                                        <i class="fas fa-list-check"></i>
                                    </div>
                                    <div>
                                        <p class="font-medium text-gray-800 text-sm">Manage Orders</p>
                                        <p class="text-xs text-gray-500">View and update orders</p>
                                    </div>
                                </button>

                                <button onclick="exportData()" class="w-full flex items-center gap-3 p-3 md:p-4 rounded-xl border-2 border-dashed border-gray-200 hover:border-gray-400 hover:bg-gray-50 transition text-left group">
                                    <div class="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center text-gray-600 group-hover:bg-gray-200 transition">
                                        <i class="fas fa-download"></i>
                                    </div>
                                    <div>
                                        <p class="font-medium text-gray-800 text-sm">Export Data</p>
                                        <p class="text-xs text-gray-500">Download backup</p>
                                    </div>
                                </button>

                                <button onclick="loadDemoData()" class="w-full flex items-center gap-3 p-3 md:p-4 rounded-xl border-2 border-dashed border-purple-200 hover:border-purple-400 hover:bg-purple-50 transition text-left group">
                                    <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center text-purple-600 group-hover:bg-purple-200 transition">
                                        <i class="fas fa-magic"></i>
                                    </div>
                                    <div>
                                        <p class="font-medium text-gray-800 text-sm">Load Demo Data</p>
                                        <p class="text-xs text-gray-500">Sample orders & customers</p>
                                    </div>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ORDERS SECTION -->
                <div id="section-orders" class="hidden fade-in">
                    <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                        <div class="p-4 md:p-6 border-b border-gray-100 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 bg-gray-50/50">
                            <div class="flex flex-wrap gap-2">
                                <button onclick="filterOrders('all')" class="filter-btn active px-3 py-1.5 rounded-full text-xs md:text-sm font-medium bg-bake-chocolate text-white transition" data-filter="all">All</button>
                                <button onclick="filterOrders('pending')" class="filter-btn px-3 py-1.5 rounded-full text-xs md:text-sm font-medium bg-gray-100 text-gray-600 hover:bg-orange-100 hover:text-orange-600 transition" data-filter="pending">Pending</button>
                                <button onclick="filterOrders('processing')" class="filter-btn px-3 py-1.5 rounded-full text-xs md:text-sm font-medium bg-gray-100 text-gray-600 hover:bg-blue-100 hover:text-blue-600 transition" data-filter="processing">Processing</button>
                                <button onclick="filterOrders('completed')" class="filter-btn px-3 py-1.5 rounded-full text-xs md:text-sm font-medium bg-gray-100 text-gray-600 hover:bg-green-100 hover:text-green-600 transition" data-filter="completed">Completed</button>
                            </div>
                            <div class="flex gap-2 w-full sm:w-auto">
                                <input type="text" id="order-search" placeholder="Search orders..." 
                                    class="flex-1 sm:w-48 px-4 py-2 rounded-xl border border-gray-200 focus:border-bake-rose outline-none text-sm"
                                    onkeyup="searchOrders()">
                            </div>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="w-full min-w-[600px]">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Order ID</th>
                                        <th class="px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Customer</th>
                                        <th class="px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Items</th>
                                        <th class="px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Total</th>
                                        <th class="px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                                        <th class="px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Date</th>
                                        <th class="px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="orders-table-body" class="divide-y divide-gray-100">
                                    <!-- Orders injected here -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="p-4 border-t border-gray-100 flex flex-col sm:flex-row justify-between items-center gap-2 bg-gray-50/30">
                            <p class="text-xs text-gray-500">Showing <span id="showing-count" class="font-medium">0</span> orders</p>
                            <div class="flex gap-2">
                                <button class="px-3 py-1.5 rounded-lg border border-gray-200 text-gray-600 hover:bg-gray-50 text-xs transition">Previous</button>
                                <button class="px-3 py-1.5 rounded-lg border border-gray-200 text-gray-600 hover:bg-gray-50 text-xs transition">Next</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PRODUCTS SECTION -->
                <div id="section-products" class="hidden fade-in">
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 md:mb-6 gap-4">
                        <div class="flex flex-wrap gap-2">
                            <button onclick="filterProducts('all')" class="prod-filter active px-4 py-2 rounded-full text-xs md:text-sm font-medium bg-bake-chocolate text-white transition">All Products</button>
                            <button onclick="filterProducts('active')" class="prod-filter px-4 py-2 rounded-full text-xs md:text-sm font-medium bg-gray-100 text-gray-600 hover:bg-gray-200 transition">Active</button>
                            <button onclick="filterProducts('inactive')" class="prod-filter px-4 py-2 rounded-full text-xs md:text-sm font-medium bg-gray-100 text-gray-600 hover:bg-gray-200 transition">Inactive</button>
                        </div>
                        <button onclick="openAddProductModal()" class="bg-bake-rose text-white px-4 py-2 rounded-full hover:bg-bake-rose-dark transition flex items-center gap-2 text-sm shadow-md hover:shadow-lg transform hover:scale-105">
                            <i class="fas fa-plus"></i> <span class="hidden sm:inline">Add Product</span>
                        </button>
                    </div>

                    <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6" id="products-grid">
                        <!-- Products injected here -->
                    </div>
                </div>

                <!-- CUSTOMERS SECTION -->
                <div id="section-customers" class="hidden fade-in">
                    <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                        <div class="p-4 md:p-6 border-b border-gray-100 bg-gray-50/50">
                            <h3 class="font-bold text-gray-800 text-sm md:text-base">Customer Database</h3>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full min-w-[600px]">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Name</th>
                                        <th class="px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Phone</th>
                                        <th class="px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Orders</th>
                                        <th class="px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Total Spent</th>
                                        <th class="px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Last Order</th>
                                        <th class="px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="customers-table-body" class="divide-y divide-gray-100">
                                    <!-- Customers injected here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- ANALYTICS SECTION -->
                <div id="section-analytics" class="hidden fade-in space-y-4 md:space-y-6">
                    <div class="grid md:grid-cols-2 gap-4 md:gap-6">
                        <div class="bg-white p-4 md:p-6 rounded-2xl shadow-sm border border-gray-100">
                            <h3 class="font-bold text-gray-800 text-sm md:text-base mb-4">Monthly Revenue</h3>
                            <div class="relative h-48 md:h-64">
                                <canvas id="monthlyRevenueChart"></canvas>
                            </div>
                        </div>
                        <div class="bg-white p-4 md:p-6 rounded-2xl shadow-sm border border-gray-100">
                            <h3 class="font-bold text-gray-800 text-sm md:text-base mb-4">Order Status Distribution</h3>
                            <div class="relative h-48 md:h-64">
                                <canvas id="statusChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white p-4 md:p-6 rounded-2xl shadow-sm border border-gray-100">
                        <h3 class="font-bold text-gray-800 text-sm md:text-base mb-4">Performance Metrics</h3>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div class="p-4 bg-gradient-to-br from-green-50 to-green-100 rounded-xl text-center border border-green-200">
                                <p class="text-2xl md:text-3xl font-bold text-green-700">98%</p>
                                <p class="text-xs text-green-600 mt-1">Satisfaction</p>
                            </div>
                            <div class="p-4 bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl text-center border border-blue-200">
                                <p class="text-2xl md:text-3xl font-bold text-blue-700">2.5h</p>
                                <p class="text-xs text-blue-600 mt-1">Avg Delivery</p>
                            </div>
                            <div class="p-4 bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl text-center border border-purple-200">
                                <p class="text-2xl md:text-3xl font-bold text-purple-700">45%</p>
                                <p class="text-xs text-purple-600 mt-1">Repeat Rate</p>
                            </div>
                            <div class="p-4 bg-gradient-to-br from-orange-50 to-orange-100 rounded-xl text-center border border-orange-200">
                                <p class="text-2xl md:text-3xl font-bold text-orange-700">â‚¹1,250</p>
                                <p class="text-xs text-orange-600 mt-1">Avg Order</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SETTINGS SECTION -->
                <div id="section-settings" class="hidden fade-in">
                    <div class="max-w-2xl mx-auto space-y-4 md:space-y-6">
                        <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                            <div class="p-4 md:p-6 border-b border-gray-100 bg-gray-50/50">
                                <h3 class="font-bold text-gray-800 text-sm md:text-base">Store Settings</h3>
                            </div>
                            <div class="p-4 md:p-6 space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Store Name</label>
                                    <input type="text" value="Bake-GPT" class="w-full px-4 py-2 rounded-xl border border-gray-200 focus:border-bake-rose focus:ring-2 focus:ring-bake-rose/20 outline-none transition text-sm">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Contact Phone</label>
                                    <input type="text" value="90441 45241" class="w-full px-4 py-2 rounded-xl border border-gray-200 focus:border-bake-rose focus:ring-2 focus:ring-bake-rose/20 outline-none transition text-sm">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">WhatsApp Number</label>
                                    <input type="text" value="9871987360" class="w-full px-4 py-2 rounded-xl border border-gray-200 focus:border-bake-rose focus:ring-2 focus:ring-bake-rose/20 outline-none transition text-sm">
                                </div>
                                <div class="flex items-center justify-between p-4 bg-gray-50 rounded-xl">
                                    <div>
                                        <p class="font-medium text-gray-800 text-sm">Accepting Orders</p>
                                        <p class="text-xs text-gray-500">Toggle to pause new orders</p>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" checked class="sr-only peer">
                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-bake-rose"></div>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                            <div class="p-4 md:p-6 border-b border-gray-100 bg-gray-50/50">
                                <h3 class="font-bold text-gray-800 text-sm md:text-base">Security & Data</h3>
                            </div>
                            <div class="p-4 md:p-6 space-y-3">
                                <button onclick="changePassword()" class="w-full text-left px-4 py-3 rounded-xl border border-gray-200 hover:border-bake-rose hover:bg-bake-rose/5 transition flex justify-between items-center group">
                                    <span class="text-sm font-medium text-gray-700 group-hover:text-bake-chocolate">Change Password</span>
                                    <i class="fas fa-chevron-right text-gray-400 group-hover:text-bake-rose"></i>
                                </button>
                                <button onclick="backupData()" class="w-full text-left px-4 py-3 rounded-xl border border-gray-200 hover:border-bake-rose hover:bg-bake-rose/5 transition flex justify-between items-center group">
                                    <span class="text-sm font-medium text-gray-700 group-hover:text-bake-chocolate">Backup All Data</span>
                                    <i class="fas fa-download text-gray-400 group-hover:text-bake-rose"></i>
                                </button>
                                <button onclick="clearAllData()" class="w-full text-left px-4 py-3 rounded-xl border border-red-200 hover:border-red-400 hover:bg-red-50 transition flex justify-between items-center group">
                                    <span class="text-sm font-medium text-red-600">Clear All Data</span>
                                    <i class="fas fa-trash text-red-400"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </main>
    </div>

    <!-- ADD/EDIT PRODUCT MODAL -->
    <div id="product-modal" class="hidden fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto transform transition-all scale-100">
            <div class="p-6 border-b border-gray-100 flex justify-between items-center bg-bake-cream/30 sticky top-0">
                <h3 class="font-bold text-lg text-bake-chocolate" id="modal-title">Add New Product</h3>
                <button onclick="closeProductModal()" class="text-gray-400 hover:text-gray-600 w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100 transition">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <form id="product-form" onsubmit="saveProduct(event)" class="p-6 space-y-4">
                <input type="hidden" id="product-id">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Product Name *</label>
                    <input type="text" id="product-name" required class="w-full px-4 py-2 rounded-xl border border-gray-200 focus:border-bake-rose focus:ring-2 focus:ring-bake-rose/20 outline-none transition text-sm">
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Price (â‚¹) *</label>
                        <input type="number" id="product-price" required min="0" class="w-full px-4 py-2 rounded-xl border border-gray-200 focus:border-bake-rose focus:ring-2 focus:ring-bake-rose/20 outline-none transition text-sm">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Unit *</label>
                        <input type="text" id="product-unit" required placeholder="per piece" class="w-full px-4 py-2 rounded-xl border border-gray-200 focus:border-bake-rose focus:ring-2 focus:ring-bake-rose/20 outline-none transition text-sm">
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Description *</label>
                    <textarea id="product-description" rows="3" required class="w-full px-4 py-2 rounded-xl border border-gray-200 focus:border-bake-rose focus:ring-2 focus:ring-bake-rose/20 outline-none transition text-sm resize-none"></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Image URL *</label>
                    <input type="url" id="product-image" required class="w-full px-4 py-2 rounded-xl border border-gray-200 focus:border-bake-rose focus:ring-2 focus:ring-bake-rose/20 outline-none transition text-sm" placeholder="https://example.com/image.jpg">
                    <p class="text-xs text-gray-500 mt-1">Use direct image URL from Unsplash or your server</p>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Tags</label>
                    <input type="text" id="product-tags" placeholder="Best Seller, Fresh, Premium (comma separated)" class="w-full px-4 py-2 rounded-xl border border-gray-200 focus:border-bake-rose focus:ring-2 focus:ring-bake-rose/20 outline-none transition text-sm">
                </div>
                <div class="flex items-center gap-2 p-3 bg-gray-50 rounded-xl">
                    <input type="checkbox" id="product-active" checked class="rounded text-bake-rose focus:ring-bake-rose w-4 h-4">
                    <label class="text-sm text-gray-700 font-medium">Active Product (visible on website)</label>
                </div>
                <div class="flex gap-3 pt-4 sticky bottom-0 bg-white pb-2">
                    <button type="button" onclick="closeProductModal()" class="flex-1 px-4 py-2.5 rounded-xl border border-gray-200 text-gray-600 hover:bg-gray-50 font-medium text-sm transition">Cancel</button>
                    <button type="submit" class="flex-1 px-4 py-2.5 rounded-xl bg-bake-rose text-white hover:bg-bake-rose-dark font-medium text-sm shadow-md transition">Save Product</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ORDER DETAIL MODAL -->
    <div id="order-modal" class="hidden fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b border-gray-100 flex justify-between items-center bg-bake-cream/30 sticky top-0">
                <h3 class="font-bold text-lg text-bake-chocolate">Order Details</h3>
                <button onclick="closeOrderModal()" class="text-gray-400 hover:text-gray-600 w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100 transition">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div id="order-detail-content" class="p-6">
                <!-- Order details injected here -->
            </div>
        </div>
    </div>

    <!-- TOAST CONTAINER -->
    <div id="toast-container" class="fixed bottom-4 right-4 z-50 flex flex-col gap-2 pointer-events-none"></div>

    <script>
        // ==================== DATA STORE ====================
        const STORE_KEYS = {
            AUTH: 'bakegpt_admin_auth_v2',
            PRODUCTS: 'bakegpt_products_v2',
            ORDERS: 'bakegpt_orders_v2',
            CUSTOMERS: 'bakegpt_customers_v2',
            SETTINGS: 'bakegpt_settings_v2'
        };

        const DEFAULT_ADMIN = {
            email: 'admin@bakegpt.com',
            password: 'admin123',
            name: 'Shahreyarr',
            role: 'superadmin'
        };

        const DEFAULT_PRODUCTS = [
            { id: 1, name: "Cupcakes", description: "Soft, fluffy cupcakes with creamy frosting in various flavors", price: 60, unit: "per piece", image: "https://images.unsplash.com/photo-1576618148400-f54bed99fcfd?w=400&h=300&fit=crop", tags: ["Best Seller", "Eggless"], active: true },
            { id: 2, name: "Blueberry Jar", description: "Layers of blueberry compote, cream, and sponge in a jar", price: 180, unit: "per jar", image: "https://images.unsplash.com/photo-1488477181946-6428a0291777?w=400&h=300&fit=crop", tags: ["Popular", "Fresh"], active: true },
            { id: 3, name: "Truffle Jar", description: "Rich chocolate truffle layers with ganache and chocolate chips", price: 200, unit: "per jar", image: "https://images.unsplash.com/photo-1606313564200-e75d5e30476c?w=400&h=300&fit=crop", tags: ["Premium"], active: true },
            { id: 4, name: "Plum Cakes", description: "Traditional rich fruit cake with dried fruits and nuts", price: 450, unit: "per 500g", image: "https://images.unsplash.com/photo-1606890737304-57a1ca8a5b62?w=400&h=300&fit=crop", tags: ["Seasonal"], active: true },
            { id: 5, name: "Brownies", description: "Fudgy, dense chocolate brownies with crackly top", price: 80, unit: "per piece", image: "https://images.unsplash.com/photo-1606313564200-e75d5e30476c?w=400&h=300&fit=crop", tags: ["Best Seller"], active: true },
            { id: 6, name: "Muffins", description: "Jumbo muffins in blueberry, chocolate, and vanilla flavors", price: 70, unit: "per piece", image: "https://images.unsplash.com/photo-1607958996333-41aef7caefaa?w=400&h=300&fit=crop", tags: ["Fresh Daily"], active: true }
        ];

        // ==================== STATE ====================
        let currentUser = null;
        let products = [];
        let orders = [];
        let customers = [];
        let salesChart = null;
        let productsChart = null;
        let monthlyChart = null;
        let statusChart = null;
        let currentOrderFilter = 'all';
        let currentProductFilter = 'all';

        // ==================== INITIALIZATION ====================
        document.addEventListener('DOMContentLoaded', () => {
            console.log('ðŸ§ Bake-GPT Admin Initializing...');
            initStore();
            checkAuth();
            updateDate();
            
            // Close dropdowns when clicking outside
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.relative')) {
                    document.getElementById('notifications-dropdown').classList.add('hidden');
                }
            });
        });

        function initStore() {
            // Clear old version data if exists (migration)
            const oldKeys = ['bakegpt_admin_auth', 'bakegpt_products', 'bakegpt_orders', 'bakegpt_customers'];
            oldKeys.forEach(key => {
                if (localStorage.getItem(key) && !localStorage.getItem(key + '_v2')) {
                    localStorage.setItem(key + '_v2', localStorage.getItem(key));
                }
            });

            // Initialize with defaults if empty
            if (!localStorage.getItem(STORE_KEYS.PRODUCTS)) {
                localStorage.setItem(STORE_KEYS.PRODUCTS, JSON.stringify(DEFAULT_PRODUCTS));
                console.log('âœ… Default products loaded');
            }
            if (!localStorage.getItem(STORE_KEYS.ORDERS)) {
                localStorage.setItem(STORE_KEYS.ORDERS, JSON.stringify([]));
            }
            if (!localStorage.getItem(STORE_KEYS.CUSTOMERS)) {
                localStorage.setItem(STORE_KEYS.CUSTOMERS, JSON.stringify([]));
            }
            
            loadData();
        }

        function loadData() {
            try {
                products = JSON.parse(localStorage.getItem(STORE_KEYS.PRODUCTS)) || DEFAULT_PRODUCTS;
                orders = JSON.parse(localStorage.getItem(STORE_KEYS.ORDERS)) || [];
                customers = JSON.parse(localStorage.getItem(STORE_KEYS.CUSTOMERS)) || [];
                console.log(`ðŸ“Š Loaded: ${products.length} products, ${orders.length} orders, ${customers.length} customers`);
            } catch (e) {
                console.error('Error loading data:', e);
                products = DEFAULT_PRODUCTS;
                orders = [];
                customers = [];
            }
        }

        function saveData() {
            try {
                localStorage.setItem(STORE_KEYS.PRODUCTS, JSON.stringify(products));
                localStorage.setItem(STORE_KEYS.ORDERS, JSON.stringify(orders));
                localStorage.setItem(STORE_KEYS.CUSTOMERS, JSON.stringify(customers));
                return true;
            } catch (e) {
                console.error('Error saving data:', e);
                showToast('Error saving data!', 'error');
                return false;
            }
        }

        // ==================== AUTHENTICATION ====================
        function checkAuth() {
            const auth = localStorage.getItem(STORE_KEYS.AUTH);
            if (auth) {
                try {
                    currentUser = JSON.parse(auth);
                    // Check if session expired (24 hours)
                    const loginTime = new Date(currentUser.loginTime);
                    const now = new Date();
                    const hoursDiff = (now - loginTime) / (1000 * 60 * 60);
                    
                    if (hoursDiff > 24) {
                        logout();
                        return;
                    }
                    
                    showDashboard();
                } catch (e) {
                    logout();
                }
            } else {
                showLogin();
            }
        }

        function handleLogin(e) {
            e.preventDefault();
            const email = document.getElementById('login-email').value.trim();
            const password = document.getElementById('login-password').value;
            const btn = document.getElementById('login-btn');
            const btnText = document.getElementById('btn-text');
            const btnIcon = document.getElementById('btn-icon');
            
            // Show loading
            btn.disabled = true;
            btnText.textContent = 'Signing in...';
            btnIcon.className = 'loading';
            
            setTimeout(() => {
                if (email === DEFAULT_ADMIN.email && password === DEFAULT_ADMIN.password) {
                    currentUser = { 
                        email, 
                        name: DEFAULT_ADMIN.name, 
                        role: DEFAULT_ADMIN.role, 
                        loginTime: new Date().toISOString() 
                    };
                    localStorage.setItem(STORE_KEYS.AUTH, JSON.stringify(currentUser));
                    
                    // Reset button
                    btn.disabled = false;
                    btnText.textContent = 'Sign In';
                    btnIcon.className = 'fas fa-arrow-right';
                    
                    showDashboard();
                    showToast('Welcome back, ' + currentUser.name + '! ðŸ‘‹', 'success');
                } else {
                    // Reset button
                    btn.disabled = false;
                    btnText.textContent = 'Sign In';
                    btnIcon.className = 'fas fa-arrow-right';
                    
                    showToast('Invalid email or password!', 'error');
                    // Shake animation
                    const form = document.getElementById('login-form');
                    form.classList.add('animate-pulse');
                    setTimeout(() => form.classList.remove('animate-pulse'), 500);
                }
            }, 800);
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                localStorage.removeItem(STORE_KEYS.AUTH);
                currentUser = null;
                
                // Destroy charts
                if (salesChart) salesChart.destroy();
                if (productsChart) productsChart.destroy();
                if (monthlyChart) monthlyChart.destroy();
                if (statusChart) statusChart.destroy();
                
                showLogin();
                showToast('Logged out successfully', 'success');
            }
        }

        function showLogin() {
            document.getElementById('login-page').classList.remove('hidden');
            document.getElementById('admin-dashboard').classList.add('hidden');
            document.body.classList.remove('overflow-hidden');
        }

        function showDashboard() {
            document.getElementById('login-page').classList.add('hidden');
            document.getElementById('admin-dashboard').classList.remove('hidden');
            document.body.classList.add('overflow-hidden');
            
            // Initialize dashboard with delay to ensure DOM is ready
            setTimeout(() => {
                refreshAllData();
            }, 100);
        }

        // ==================== NAVIGATION ====================
        function showSection(sectionName) {
            // Hide all sections
            ['dashboard', 'orders', 'products', 'customers', 'analytics', 'settings'].forEach(sec => {
                const el = document.getElementById(`section-${sec}`);
                if (el) el.classList.add('hidden');
                
                const nav = document.getElementById(`nav-${sec}`);
                if (nav) nav.classList.remove('active');
            });
            
            // Show selected
            const selectedSection = document.getElementById(`section-${sectionName}`);
            const selectedNav = document.getElementById(`nav-${sectionName}`);
            
            if (selectedSection) {
                selectedSection.classList.remove('hidden');
                // Trigger reflow for animation
                void selectedSection.offsetWidth;
                selectedSection.classList.add('fade-in');
            }
            
            if (selectedNav) selectedNav.classList.add('active');
            
            // Update title
            const titles = {
                dashboard: 'Dashboard',
                orders: 'Orders Management',
                products: 'Product Catalog',
                customers: 'Customer Database',
                analytics: 'Analytics & Reports',
                settings: 'Store Settings'
            };
            const titleEl = document.getElementById('page-title');
            if (titleEl) titleEl.textContent = titles[sectionName] || 'Dashboard';
            
            // Refresh specific data
            setTimeout(() => {
                if (sectionName === 'dashboard') refreshDashboard();
                else if (sectionName === 'orders') renderOrders();
                else if (sectionName === 'products') renderProducts();
                else if (sectionName === 'customers') renderCustomers();
                else if (sectionName === 'analytics') initAnalytics();
            }, 50);
        }

        function toggleMobileSidebar() {
            const sidebar = document.getElementById('mobile-sidebar');
            if (sidebar) sidebar.classList.toggle('hidden');
        }

        // ==================== DASHBOARD ====================
        function refreshAllData() {
            loadData();
            refreshDashboard();
        }

        function refreshDashboard() {
            try {
                updateStats();
                renderRecentOrders();
                initCharts();
            } catch (e) {
                console.error('Dashboard refresh error:', e);
            }
        }

        function updateStats() {
            const today = new Date().toDateString();
            const todayOrders = orders.filter(o => new Date(o.date).toDateString() === today);
            const todayRevenue = todayOrders.reduce((sum, o) => sum + (o.total || 0), 0);
            const pendingOrders = orders.filter(o => o.status === 'pending').length;
            
            // Update DOM elements safely
            const setText = (id, text) => {
                const el = document.getElementById(id);
                if (el) el.textContent = text;
            };
            
            setText('stat-today-orders', todayOrders.length);
            setText('stat-today-revenue', 'â‚¹' + todayRevenue.toLocaleString());
            setText('stat-pending', pendingOrders);
            setText('stat-customers', customers.length);
            setText('stat-new-customers', Math.floor(Math.random() * 5) + 1); // Simulated
            
            // Update sidebar badge
            const badge = document.getElementById('sidebar-order-count');
            if (badge) {
                if (pendingOrders > 0) {
                    badge.textContent = pendingOrders;
                    badge.classList.remove('hidden');
                } else {
                    badge.classList.add('hidden');
                }
            }
        }

        function renderRecentOrders() {
            const container = document.getElementById('recent-orders-list');
            if (!container) return;
            
            const recent = [...orders].sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 5);
            
            if (recent.length === 0) {
                container.innerHTML = `
                    <div class="p-8 text-center text-gray-400">
                        <i class="fas fa-inbox text-4xl mb-3 text-gray-300"></i>
                        <p class="text-sm">No orders yet</p>
                        <button onclick="loadDemoData()" class="mt-3 text-bake-rose text-sm hover:underline">Load demo data</button>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = recent.map(order => `
                <div class="flex items-center justify-between p-4 hover:bg-gray-50 transition cursor-pointer border-b border-gray-50 last:border-0" onclick="viewOrder(${order.id})">
                    <div class="flex items-center gap-3 md:gap-4">
                        <div class="w-10 h-10 md:w-12 md:h-12 bg-bake-rose/20 rounded-xl flex items-center justify-center text-bake-rose flex-shrink-0">
                            <i class="fas fa-shopping-bag"></i>
                        </div>
                        <div class="min-w-0">
                            <p class="font-bold text-gray-800 text-sm md:text-base truncate">#${order.id.toString().padStart(4, '0')}</p>
                            <p class="text-xs md:text-sm text-gray-500 truncate">${order.customer}</p>
                        </div>
                    </div>
                    <div class="text-right flex-shrink-0">
                        <p class="font-bold text-bake-chocolate text-sm md:text-base">â‚¹${order.total}</p>
                        <span class="text-xs px-2 py-0.5 rounded-full ${getStatusColor(order.status)}">${order.status}</span>
                    </div>
                </div>
            `).join('');
        }

        function getStatusColor(status) {
            const colors = {
                pending: 'bg-orange-100 text-orange-700',
                processing: 'bg-blue-100 text-blue-700',
                completed: 'bg-green-100 text-green-700',
                cancelled: 'bg-red-100 text-red-700'
            };
            return colors[status] || 'bg-gray-100 text-gray-700';
        }

        function initCharts() {
            try {
                // Sales Chart
                const ctx1 = document.getElementById('salesChart');
                if (!ctx1) return;
                
                if (salesChart) salesChart.destroy();
                
                salesChart = new Chart(ctx1, {
                    type: 'line',
                    data: {
                        labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                        datasets: [{
                            label: 'Sales (â‚¹)',
                            data: generateRandomData(7, 1000, 3000),
                            borderColor: '#E8B4B8',
                            backgroundColor: 'rgba(232, 180, 184, 0.1)',
                            tension: 0.4,
                            fill: true,
                            pointBackgroundColor: '#E8B4B8',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            pointRadius: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { 
                            legend: { display: false },
                            tooltip: {
                                backgroundColor: 'rgba(93, 64, 55, 0.9)',
                                padding: 12,
                                cornerRadius: 8
                            }
                        },
                        scales: { 
                            y: { 
                                beginAtZero: true,
                                grid: { color: 'rgba(0,0,0,0.05)' }
                            },
                            x: {
                                grid: { display: false }
                            }
                        }
                    }
                });

                // Products Chart
                const ctx2 = document.getElementById('productsChart');
                if (!ctx2) return;
                
                if (productsChart) productsChart.destroy();
                
                const topProducts = products.slice(0, 5);
                productsChart = new Chart(ctx2, {
                    type: 'doughnut',
                    data: {
                        labels: topProducts.map(p => p.name),
                        datasets: [{
                            data: generateRandomData(topProducts.length, 10, 50),
                            backgroundColor: ['#E8B4B8', '#D4A5A9', '#8B6F47', '#5D4037', '#FDF6F0'],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { 
                                position: 'bottom',
                                labels: { usePointStyle: true, padding: 15 }
                            }
                        },
                        cutout: '70%'
                    }
                });
            } catch (e) {
                console.error('Chart error:', e);
            }
        }

        function generateRandomData(count, min, max) {
            return Array.from({length: count}, () => Math.floor(Math.random() * (max - min + 1)) + min);
        }

        // ==================== ORDERS ====================
        function renderOrders() {
            const tbody = document.getElementById('orders-table-body');
            const showingCount = document.getElementById('showing-count');
            if (!tbody) return;
            
            let filtered = orders;
            if (currentOrderFilter !== 'all') {
                filtered = orders.filter(o => o.status === currentOrderFilter);
            }
            
            // Search filter
            const searchInput = document.getElementById('order-search');
            const search = searchInput ? searchInput.value.toLowerCase() : '';
            if (search) {
                filtered = filtered.filter(o => 
                    (o.customer && o.customer.toLowerCase().includes(search)) || 
                    o.id.toString().includes(search)
                );
            }
            
            if (showingCount) showingCount.textContent = filtered.length;
            
            if (filtered.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7" class="px-6 py-12 text-center text-gray-400">
                            <i class="fas fa-inbox text-4xl mb-3 text-gray-300"></i>
                            <p>No orders found</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            tbody.innerHTML = filtered.map(order => `
                <tr class="hover:bg-gray-50 transition group">
                    <td class="px-4 md:px-6 py-4 font-medium text-bake-chocolate text-sm">#${order.id.toString().padStart(4, '0')}</td>
                    <td class="px-4 md:px-6 py-4">
                        <div>
                            <p class="font-medium text-gray-800 text-sm">${order.customer}</p>
                            <p class="text-xs text-gray-500">${order.phone}</p>
                        </div>
                    </td>
                    <td class="px-4 md:px-6 py-4 text-sm text-gray-600">${order.items ? order.items.length : 0} items</td>
                    <td class="px-4 md:px-6 py-4 font-bold text-gray-800 text-sm">â‚¹${order.total}</td>
                    <td class="px-4 md:px-6 py-4">
                        <select onchange="updateOrderStatus(${order.id}, this.value)" 
                            class="text-xs px-2 py-1 rounded-full border-0 ${getStatusColor(order.status)} cursor-pointer outline-none font-medium">
                            <option value="pending" ${order.status === 'pending' ? 'selected' : ''}>Pending</option>
                            <option value="processing" ${order.status === 'processing' ? 'selected' : ''}>Processing</option>
                            <option value="completed" ${order.status === 'completed' ? 'selected' : ''}>Completed</option>
                            <option value="cancelled" ${order.status === 'cancelled' ? 'selected' : ''}>Cancelled</option>
                        </select>
                    </td>
                    <td class="px-4 md:px-6 py-4 text-xs text-gray-500 whitespace-nowrap">${new Date(order.date).toLocaleDateString()}</td>
                    <td class="px-4 md:px-6 py-4">
                        <button onclick="viewOrder(${order.id})" class="text-bake-rose hover:text-bake-rose-dark mr-2 p-1 hover:bg-bake-rose/10 rounded transition" title="View">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button onclick="deleteOrder(${order.id})" class="text-red-400 hover:text-red-600 p-1 hover:bg-red-50 rounded transition" title="Delete">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function filterOrders(status) {
            currentOrderFilter = status;
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active', 'bg-bake-chocolate', 'text-white');
                btn.classList.add('bg-gray-100', 'text-gray-600');
            });
            
            if (event && event.target) {
                event.target.classList.remove('bg-gray-100', 'text-gray-600');
                event.target.classList.add('active', 'bg-bake-chocolate', 'text-white');
            }
            renderOrders();
        }

        function searchOrders() {
            renderOrders();
        }

        function updateOrderStatus(id, status) {
            const order = orders.find(o => o.id === id);
            if (order) {
                order.status = status;
                saveData();
                showToast(`Order #${id} updated to ${status}`, 'success');
                updateStats();
                renderRecentOrders();
            }
        }

        function viewOrder(id) {
            const order = orders.find(o => o.id === id);
            if (!order) return;
            
            const content = document.getElementById('order-detail-content');
            if (!content) return;
            
            content.innerHTML = `
                <div class="space-y-6">
                    <div class="flex flex-col sm:flex-row justify-between items-start gap-4">
                        <div>
                            <p class="text-xs text-gray-500 uppercase tracking-wide">Order ID</p>
                            <h4 class="text-2xl font-bold text-bake-chocolate">#${order.id.toString().padStart(4, '0')}</h4>
                        </div>
                        <span class="px-4 py-1.5 rounded-full text-sm font-medium ${getStatusColor(order.status)}">${order.status.toUpperCase()}</span>
                    </div>
                    
                    <div class="grid sm:grid-cols-2 gap-4 bg-gray-50 p-4 rounded-xl">
                        <div>
                            <p class="text-xs text-gray-500 mb-1">Customer</p>
                            <p class="font-semibold text-gray-800">${order.customer}</p>
                            <p class="text-sm text-gray-600">${order.phone}</p>
                        </div>
                        <div>
                            <p class="text-xs text-gray-500 mb-1">Order Date</p>
                            <p class="font-semibold text-gray-800">${new Date(order.date).toLocaleString()}</p>
                        </div>
                    </div>

                    <div>
                        <p class="text-sm font-semibold text-gray-700 mb-3">Order Items</p>
                        <div class="space-y-2">
                            ${(order.items || []).map(item => `
                                <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                    <div class="flex items-center gap-3">
                                        <img src="${item.image || 'https://via.placeholder.com/50'}" class="w-12 h-12 rounded-lg object-cover bg-gray-200">
                                        <div>
                                            <p class="font-medium text-gray-800 text-sm">${item.name}</p>
                                            <p class="text-xs text-gray-500">â‚¹${item.price} Ã— ${item.quantity}</p>
                                        </div>
                                    </div>
                                    <p class="font-bold text-gray-800">â‚¹${(item.price || 0) * (item.quantity || 1)}</p>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div class="border-t pt-4">
                        <div class="flex justify-between items-center text-xl font-bold text-bake-chocolate">
                            <span>Total Amount</span>
                            <span>â‚¹${order.total}</span>
                        </div>
                    </div>

                    <div class="flex flex-col sm:flex-row gap-3 pt-2">
                        <button onclick="closeOrderModal()" class="flex-1 px-4 py-3 rounded-xl border border-gray-200 text-gray-600 hover:bg-gray-50 font-medium transition">Close</button>
                        <a href="https://wa.me/91${order.phone}?text=Hi ${order.customer}, your order #${order.id} is ${order.status}. Total: â‚¹${order.total}" target="_blank" 
                            class="flex-1 px-4 py-3 rounded-xl bg-green-500 text-white text-center hover:bg-green-600 font-medium transition flex items-center justify-center gap-2">
                            <i class="fab fa-whatsapp"></i> Contact Customer
                        </a>
                    </div>
                </div>
            `;
            
            const modal = document.getElementById('order-modal');
            if (modal) modal.classList.remove('hidden');
        }

        function closeOrderModal() {
            const modal = document.getElementById('order-modal');
            if (modal) modal.classList.add('hidden');
        }

        function deleteOrder(id) {
            if (confirm('Are you sure you want to delete this order? This cannot be undone.')) {
                orders = orders.filter(o => o.id !== id);
                saveData();
                renderOrders();
                updateStats();
                renderRecentOrders();
                showToast('Order deleted successfully', 'success');
            }
        }

        // ==================== PRODUCTS ====================
        function renderProducts() {
            const grid = document.getElementById('products-grid');
            if (!grid) return;
            
            let filtered = products;
            if (currentProductFilter === 'active') filtered = products.filter(p => p.active);
            if (currentProductFilter === 'inactive') filtered = products.filter(p => !p.active);
            
            if (filtered.length === 0) {
                grid.innerHTML = `
                    <div class="col-span-full text-center py-12 text-gray-400">
                        <i class="fas fa-cake text-4xl mb-3 text-gray-300"></i>
                        <p>No products found</p>
                    </div>
                `;
                return;
            }
            
            grid.innerHTML = filtered.map(product => `
                <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden group hover:shadow-lg transition-all duration-300">
                    <div class="relative h-48 overflow-hidden bg-gray-100">
                        <img src="${product.image}" alt="${product.name}" 
                            class="w-full h-full object-cover transform group-hover:scale-110 transition duration-500"
                            onerror="this.src='https://via.placeholder.com/400x300?text=No+Image'">
                        <div class="absolute top-3 right-3">
                            ${product.active ? 
                                '<span class="bg-green-500 text-white text-xs px-2 py-1 rounded-full shadow-sm">Active</span>' : 
                                '<span class="bg-gray-500 text-white text-xs px-2 py-1 rounded-full shadow-sm">Inactive</span>'
                            }
                        </div>
                        <div class="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition flex items-center justify-center gap-2">
                            <button onclick="editProduct(${product.id})" class="w-10 h-10 bg-white rounded-full flex items-center justify-center text-bake-chocolate hover:bg-bake-rose hover:text-white transition shadow-lg" title="Edit">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="toggleProductStatus(${product.id})" class="w-10 h-10 bg-white rounded-full flex items-center justify-center text-gray-600 hover:bg-gray-100 transition shadow-lg" title="${product.active ? 'Deactivate' : 'Activate'}">
                                <i class="fas fa-${product.active ? 'eye-slash' : 'eye'}"></i>
                            </button>
                            <button onclick="deleteProduct(${product.id})" class="w-10 h-10 bg-white rounded-full flex items-center justify-center text-red-500 hover:bg-red-50 transition shadow-lg" title="Delete">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="p-5">
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="font-serif text-lg font-bold text-bake-chocolate line-clamp-1">${product.name}</h3>
                            <span class="text-bake-rose font-bold">â‚¹${product.price}</span>
                        </div>
                        <p class="text-sm text-gray-600 mb-3 line-clamp-2 h-10">${product.description}</p>
                        <div class="flex flex-wrap gap-1.5">
                            ${(product.tags || []).slice(0, 3).map(tag => `<span class="text-xs bg-bake-rose/10 text-bake-rose-dark px-2 py-1 rounded-full">${tag}</span>`).join('')}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function filterProducts(filter) {
            currentProductFilter = filter;
            document.querySelectorAll('.prod-filter').forEach(btn => {
                btn.classList.remove('active', 'bg-bake-chocolate', 'text-white');
                btn.classList.add('bg-gray-100', 'text-gray-600');
            });
            
            if (event && event.target) {
                event.target.classList.remove('bg-gray-100', 'text-gray-600');
                event.target.classList.add('active', 'bg-bake-chocolate', 'text-white');
            }
            renderProducts();
        }

        function openAddProductModal() {
            const form = document.getElementById('product-form');
            const modal = document.getElementById('product-modal');
            const title = document.getElementById('modal-title');
            
            if (form) form.reset();
            const idInput = document.getElementById('product-id');
            if (idInput) idInput.value = '';
            if (title) title.textContent = 'Add New Product';
            
            if (modal) modal.classList.remove('hidden');
        }

        function editProduct(id) {
            const product = products.find(p => p.id === id);
            if (!product) return;
            
            const fields = {
                'product-id': product.id,
                'product-name': product.name,
                'product-price': product.price,
                'product-unit': product.unit,
                'product-description': product.description,
                'product-image': product.image,
                'product-tags': (product.tags || []).join(', '),
                'product-active': product.active
            };
            
            Object.keys(fields).forEach(key => {
                const el = document.getElementById(key);
                if (el) {
                    if (el.type === 'checkbox') el.checked = fields[key];
                    else el.value = fields[key];
                }
            });
            
            const title = document.getElementById('modal-title');
            if (title) title.textContent = 'Edit Product';
            
            const modal = document.getElementById('product-modal');
            if (modal) modal.classList.remove('hidden');
        }

        function closeProductModal() {
            const modal = document.getElementById('product-modal');
            if (modal) modal.classList.add('hidden');
        }

        function saveProduct(e) {
            e.preventDefault();
            
            const getValue = (id) => {
                const el = document.getElementById(id);
                return el ? el.value : '';
            };
            
            const getChecked = (id) => {
                const el = document.getElementById(id);
                return el ? el.checked : false;
            };
            
            const id = getValue('product-id');
            const productData = {
                id: id ? parseInt(id) : Date.now(),
                name: getValue('product-name'),
                price: parseInt(getValue('product-price')) || 0,
                unit: getValue('product-unit'),
                description: getValue('product-description'),
                image: getValue('product-image'),
                tags: getValue('product-tags').split(',').map(t => t.trim()).filter(t => t),
                active: getChecked('product-active')
            };
            
            if (id) {
                const index = products.findIndex(p => p.id === parseInt(id));
                if (index !== -1) products[index] = productData;
                showToast('Product updated successfully! âœ¨', 'success');
            } else {
                products.push(productData);
                showToast('Product added successfully! ðŸŽ‰', 'success');
            }
            
            saveData();
            closeProductModal();
            renderProducts();
        }

        function toggleProductStatus(id) {
            const product = products.find(p => p.id === id);
            if (product) {
                product.active = !product.active;
                saveData();
                renderProducts();
                showToast(`Product ${product.active ? 'activated' : 'deactivated'} ðŸ‘`, 'success');
            }
        }

        function deleteProduct(id) {
            if (confirm('Are you sure you want to delete this product? This cannot be undone.')) {
                products = products.filter(p => p.id !== id);
                saveData();
                renderProducts();
                showToast('Product deleted', 'success');
            }
        }

        // ==================== CUSTOMERS ====================
        function renderCustomers() {
            const tbody = document.getElementById('customers-table-body');
            if (!tbody) return;
            
            if (customers.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" class="px-6 py-12 text-center text-gray-400">
                            <i class="fas fa-users text-4xl mb-3 text-gray-300"></i>
                            <p>No customers yet</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            tbody.innerHTML = customers.map(cust => `
                <tr class="hover:bg-gray-50 transition">
                    <td class="px-4 md:px-6 py-4 font-medium text-gray-800">${cust.name}</td>
                    <td class="px-4 md:px-6 py-4 text-sm text-gray-600 font-mono">${cust.phone}</td>
                    <td class="px-4 md:px-6 py-4 text-sm text-gray-600">
                        <span class="bg-bake-rose/10 text-bake-rose-dark px-2 py-1 rounded-full text-xs font-medium">${cust.orderCount || 0} orders</span>
                    </td>
                    <td class="px-4 md:px-6 py-4 font-medium text-bake-chocolate">â‚¹${cust.totalSpent || 0}</td>
                    <td class="px-4 md:px-6 py-4 text-sm text-gray-500">${cust.lastOrder ? new Date(cust.lastOrder).toLocaleDateString() : '-'}</td>
                    <td class="px-4 md:px-6 py-4">
                        <button onclick="viewCustomer('${cust.phone}')" class="text-bake-rose hover:text-bake-rose-dark text-sm font-medium hover:underline">
                            View
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function viewCustomer(phone) {
            const customer = customers.find(c => c.phone === phone);
            if (!customer) return;
            alert(`Customer Details:\n\nName: ${customer.name}\nPhone: ${customer.phone}\nTotal Orders: ${customer.orderCount || 0}\nTotal Spent: â‚¹${customer.totalSpent || 0}\nLast Order: ${customer.lastOrder ? new Date(customer.lastOrder).toLocaleDateString() : 'Never'}`);
        }

        // ==================== ANALYTICS ====================
        function initAnalytics() {
            try {
                // Monthly Revenue Chart
                const ctx1 = document.getElementById('monthlyRevenueChart');
                if (ctx1) {
                    if (monthlyChart) monthlyChart.destroy();
                    monthlyChart = new Chart(ctx1, {
                        type: 'bar',
                        data: {
                            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                            datasets: [{
                                label: 'Revenue (â‚¹)',
                                data: generateRandomData(6, 30000, 70000),
                                backgroundColor: '#E8B4B8',
                                borderRadius: 6
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: { legend: { display: false } },
                            scales: { 
                                y: { beginAtZero: true, grid: { color: 'rgba(0,0,0,0.05)' } },
                                x: { grid: { display: false } }
                            }
                        }
                    });
                }

                // Status Distribution Chart
                const ctx2 = document.getElementById('statusChart');
                if (ctx2) {
                    if (statusChart) statusChart.destroy();
                    const statusCounts = {
                        pending: orders.filter(o => o.status === 'pending').length,
                        processing: orders.filter(o => o.status === 'processing').length,
                        completed: orders.filter(o => o.status === 'completed').length,
                        cancelled: orders.filter(o => o.status === 'cancelled').length
                    };
                    
                    statusChart = new Chart(ctx2, {
                        type: 'pie',
                        data: {
                            labels: ['Pending', 'Processing', 'Completed', 'Cancelled'],
                            datasets: [{
                                data: [statusCounts.pending, statusCounts.processing, statusCounts.completed, statusCounts.cancelled],
                                backgroundColor: ['#FCD34D', '#60A5FA', '#34D399', '#F87171'],
                                borderWidth: 2,
                                borderColor: '#fff'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { position: 'bottom', labels: { usePointStyle: true } }
                            }
                        }
                    });
                }
            } catch (e) {
                console.error('Analytics chart error:', e);
            }
        }

        // ==================== SETTINGS & UTILITIES ====================
        function changePassword() {
            const current = prompt('Enter current password:');
            if (current !== DEFAULT_ADMIN.password) {
                showToast('Incorrect current password!', 'error');
                return;
            }
            const newPass = prompt('Enter new password (min 6 characters):');
            if (newPass && newPass.length >= 6) {
                DEFAULT_ADMIN.password = newPass;
                showToast('Password updated successfully! ðŸ”’', 'success');
            } else if (newPass) {
                showToast('Password too short!', 'error');
            }
        }

        function backupData() {
            const data = {
                products,
                orders,
                customers,
                exportDate: new Date().toISOString(),
                version: '2.0'
            };
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `bakegpt-backup-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showToast('Backup downloaded! ðŸ’¾', 'success');
        }

        function exportData() {
            backupData();
        }

        function clearAllData() {
            if (confirm('âš ï¸ WARNING: This will delete ALL data including orders, products, and customers. This cannot be undone!')) {
                if (confirm('Are you absolutely sure? Everything will be lost forever!')) {
                    localStorage.removeItem(STORE_KEYS.PRODUCTS);
                    localStorage.removeItem(STORE_KEYS.ORDERS);
                    localStorage.removeItem(STORE_KEYS.CUSTOMERS);
                    loadData();
                    refreshAllData();
                    showToast('All data cleared! ðŸ—‘ï¸', 'success');
                }
            }
        }

        function refreshData() {
            loadData();
            refreshDashboard();
            showToast('Data refreshed! ðŸ”„', 'success');
        }

        function toggleNotifications() {
            const dropdown = document.getElementById('notifications-dropdown');
            if (dropdown) dropdown.classList.toggle('hidden');
        }

        function updateDate() {
            const el = document.getElementById('current-date');
            if (el) {
                const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                el.textContent = new Date().toLocaleDateString('en-US', options);
            }
        }

        // ==================== DEMO DATA ====================
        function loadDemoAndLogin() {
            loadDemoData();
            setTimeout(() => {
                document.getElementById('login-email').value = DEFAULT_ADMIN.email;
                document.getElementById('login-password').value = DEFAULT_ADMIN.password;
                handleLogin({ preventDefault: () => {} });
            }, 500);
        }

        function loadDemoData() {
            // Create sample orders
            const sampleOrders = [
                {
                    id: 1001,
                    customer: "Priya Sharma",
                    phone: "9876543210",
                    items: [
                        { name: "Cupcakes", price: 60, quantity: 6, image: products[0].image },
                        { name: "Blueberry Jar", price: 180, quantity: 2, image: products[1].image }
                    ],
                    total: 720,
                    status: "completed",
                    date: new Date(Date.now() - 86400000).toISOString()
                },
                {
                    id: 1002,
                    customer: "Rahul Verma",
                    phone: "9876543211",
                    items: [
                        { name: "Truffle Jar", price: 200, quantity: 1, image: products[2].image }
                    ],
                    total: 200,
                    status: "pending",
                    date: new Date().toISOString()
                },
                {
                    id: 1003,
                    customer: "Anita Gupta",
                    phone: "9876543212",
                    items: [
                        { name: "Brownies", price: 80, quantity: 4, image: products[4].image },
                        { name: "Muffins", price: 70, quantity: 2, image: products[5].image }
                    ],
                    total: 460,
                    status: "processing",
                    date: new Date(Date.now() - 3600000).toISOString()
                },
                {
                    id: 1004,
                    customer: "Vikram Patel",
                    phone: "9876543213",
                    items: [
                        { name: "Plum Cakes", price: 450, quantity: 1, image: products[3].image }
                    ],
                    total: 450,
                    status: "completed",
                    date: new Date(Date.now() - 172800000).toISOString()
                }
            ];

            // Create sample customers
            const sampleCustomers = [
                { name: "Priya Sharma", phone: "9876543210", orderCount: 5, totalSpent: 3600, lastOrder: new Date(Date.now() - 86400000).toISOString() },
                { name: "Rahul Verma", phone: "9876543211", orderCount: 2, totalSpent: 800, lastOrder: new Date().toISOString() },
                { name: "Anita Gupta", phone: "9876543212", orderCount: 8, totalSpent: 5200, lastOrder: new Date(Date.now() - 3600000).toISOString() },
                { name: "Vikram Patel", phone: "9876543213", orderCount: 3, totalSpent: 2100, lastOrder: new Date(Date.now() - 172800000).toISOString() }
            ];

            orders = sampleOrders;
            customers = sampleCustomers;
            saveData();
            
            if (!document.getElementById('admin-dashboard').classList.contains('hidden')) {
                refreshAllData();
            }
            
            showToast('Demo data loaded! ðŸŽ‰', 'success');
        }

        // ==================== TOAST NOTIFICATIONS ====================
        function showToast(message, type = 'success') {
            const container = document.getElementById('toast-container');
            if (!container) return;
            
            const toast = document.createElement('div');
            const colors = type === 'success' 
                ? 'bg-gradient-to-r from-green-500 to-green-600' 
                : 'bg-gradient-to-r from-red-500 to-red-600';
            const icon = type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle';
            
            toast.className = `${colors} text-white px-6 py-3 rounded-xl shadow-2xl flex items-center gap-3 transform translate-y-10 opacity-0 transition-all duration-300 pointer-events-auto min-w-[300px]`;
            toast.innerHTML = `
                <i class="fas ${icon} text-xl"></i>
                <span class="font-medium text-sm">${message}</span>
            `;
            
            container.appendChild(toast);
            
            // Animate in
            requestAnimationFrame(() => {
                toast.classList.remove('translate-y-10', 'opacity-0');
            });
            
            // Remove after delay
            setTimeout(() => {
                toast.classList.add('translate-y-10', 'opacity-0');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Close modals on outside click
        window.onclick = function(event) {
            if (event.target.classList.contains('fixed') && event.target.classList.contains('backdrop-blur-sm')) {
                event.target.classList.add('hidden');
            }
        }
    </script>
</body>
</html>